<!DOCTYPE html>
<html>
  <head>
    <link rel="manifest" href="./manifest.json">
  </head>
  <body>
    <script>
      const divInstall = document.getElementById("installContainer");
      const butInstall = document.getElementById("butInstall");
      
      window.addEventListener("beforeinstallprompt", (event) => {
        event.preventDefault();
        alert("üëç", "beforeinstallprompt", event);
        window.deferredPrompt = event;
        divInstall.classList.toggle("hidden", false);
      });
      
      butInstall.addEventListener("click", async () => {
        alert("üëç", "butInstall-clicked");
        const promptEvent = window.deferredPrompt;
        if (!promptEvent) {
          return;
        }
        promptEvent.prompt();
        const result = await promptEvent.userChoice;
        alert("üëç", "userChoice", result);
        window.deferredPrompt = null;
        divInstall.classList.toggle("hidden", true);
      });
      
      window.addEventListener("appinstalled", (event) => {
        alert("üëç", "appinstalled", event);
        window.deferredPrompt = null;
      });
      
      if (window.location.protocol === "http:") {
        const requireHTTPS = document.getElementById("requireHTTPS");
        const link = requireHTTPS.querySelector("a");
        link.href = window.location.href.replace("http://", "https://");
        requireHTTPS.classList.remove("hidden");
      }
      
      if (window.self !== window.top) {
        const requireTopLevel = document.getElementById("requireTopLevel");
        const link = requireTopLevel.querySelector("a");
        link.href = window.location.href;
        requireTopLevel.classList.remove("hidden");
      }

       if (window.matchMedia('(display-mode: standalone)').matches || navigator.standalone == true) window.location.href = 'https://t3.chat';
    </script>
  </body>
</html>
